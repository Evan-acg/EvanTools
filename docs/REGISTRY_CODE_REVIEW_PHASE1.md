# Registry æ¨¡å— - ä»£ç å®¡æŸ¥ ç¬¬ä¸€é˜¶æ®µæŠ¥å‘Š

**æ—¥æœŸ**: 2026-01-25  
**é˜¶æ®µ**: åˆå§‹æµ‹è¯•å’Œ API ç ”ç©¶  
**å·¥ä½œåŒº**: code-review/registry  
**çŠ¶æ€**: è¿›è¡Œä¸­

---

## å‘ç° 1: API ä¸åŒ¹é…é—®é¢˜

åˆå§‹æµ‹è¯•è¿è¡Œæš´éœ²äº†ä¸€ä¸ªé‡å¤§é—®é¢˜ï¼š**æµ‹è¯•ä»£ç ä¸å®é™… API ä¸åŒ¹é…**ã€‚

### é—®é¢˜åˆ—è¡¨

#### Discovery å±‚ API ä¸åŒ¹é…

1. **CommandMetadata** æ„é€ å‡½æ•°é”™è¯¯
   - âŒ é”™è¯¯: `CommandMetadata(name, group, doc, signature)`
   - âœ… æ­£ç¡®: `CommandMetadata(name, group, func, docstring, module, signature)`
   - **å½±å“**: æ‰€æœ‰æ¶‰åŠ CommandMetadata çš„æµ‹è¯•éƒ½å¤±è´¥äº†ï¼ˆ11 ä¸ªæµ‹è¯•ï¼‰
   - **ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜ - å…ƒæ•°æ®æ¨¡å‹ä¸æ–‡æ¡£ä¸ç¬¦
   - **æ ¹æœ¬åŸå› **: æ–‡æ¡£ç¤ºä¾‹ç®€åŒ–äº†å®é™…çš„æ•°æ®æ¨¡å‹ï¼Œå®é™…éœ€è¦ä¿å­˜å‡½æ•°å¼•ç”¨å’Œæ¨¡å—ä¿¡æ¯

2. **CommandInspector** æ–¹æ³•åé”™è¯¯
   - âŒ é”™è¯¯: `inspector.inspect(func)`
   - âœ… æ­£ç¡®: `inspector.extract_metadata(func)`
   - **å½±å“**: 3 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜ - æ ¸å¿ƒ API æ–¹æ³•åä¸ç›´è§‚
   - **å»ºè®®**: æ–¹æ³•åä¸å¤Ÿæ¸…æ™°ï¼Œåº”è¯¥æ›´ç›´è§‚

#### Tracking å±‚ API ä¸åŒ¹é…

3. **ExecutionRecord** å‚æ•°é”™è¯¯
   - âŒ é”™è¯¯: `ExecutionRecord(command=...)`
   - âœ… æ­£ç¡®: `ExecutionRecord(command_name=...)`
   - **å½±å“**: 9 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜ - å…³é”®æ•°æ®æ¨¡å‹å‚æ•°é”™è¯¯
   - **é—®é¢˜**: README æ–‡æ¡£ä¸­ä½¿ç”¨çš„æ˜¯ç®€åŒ–ç¤ºä¾‹ï¼Œå®é™…å‚æ•°æ›´è¯¦ç»†

4. **PerformanceStats** å‚æ•°é”™è¯¯
   - âŒ é”™è¯¯: `PerformanceStats(command=...)`
   - âœ… æ­£ç¡®: `PerformanceStats(command_name=...)`
   - **å½±å“**: 2 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸ”´ é«˜ - æ•°æ®æ¨¡å‹ä¸ä¸€è‡´

5. **ExecutionTracker** å±æ€§é”™è¯¯
   - âŒ é”™è¯¯: `tracker._tracking`
   - âœ… æ­£ç¡®: `tracker.is_tracking_enabled()`
   - **å½±å“**: 3 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä¸­ - è®¿é—®å†…éƒ¨çŠ¶æ€è€Œéå…¬å…± API
   - **è®¾è®¡é—®é¢˜**: ExecutionTracker åº”è¯¥æä¾›å…¬å…±çš„çŠ¶æ€æŸ¥è¯¢æ–¹æ³•

#### Visualization å±‚ API ä¸åŒ¹é…

6. **TableFormatter** æ–¹æ³•åé”™è¯¯
   - âŒ é”™è¯¯: `formatter.format(headers, rows)`
   - âœ… æ­£ç¡®: `formatter.format_table(headers, rows)`
   - **å½±å“**: 3 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä¸­ - æ–¹æ³•åä¸å¤Ÿæ ‡å‡†
   - **å»ºè®®**: åº”è¯¥ä½¿ç”¨æ›´æ ‡å‡†çš„æ–¹æ³•åï¼ˆå¦‚ `format_table` æˆ– `format`ï¼‰

7. **TableConfig** å‚æ•°é”™è¯¯
   - âŒ é”™è¯¯: `TableConfig(border_style=..., header_separator=...)`
   - âœ… æ­£ç¡®: `TableConfig(padding=..., border_char=..., col_sep=...)`
   - **å½±å“**: 1 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä¸­ - é…ç½®å‚æ•°å‘½åä¸ç›´è§‚
   - **é—®é¢˜**: å®é™…å‚æ•°ï¼ˆ`border_char`, `col_sep`ï¼‰ä¸å¤Ÿè‡ªè§£é‡Š

8. **PerformanceMonitor** æ–¹æ³•åé”™è¯¯
   - âŒ é”™è¯¯: `monitor.get_performance_stats()`
   - âœ… æ­£ç¡®: `monitor.get_stats()` æˆ– `monitor.get_all_stats()`
   - **å½±å“**: 2 ä¸ªæµ‹è¯•å¤±è´¥
   - **ä¸¥é‡ç¨‹åº¦**: ğŸŸ¡ ä¸­ - æ–¹æ³•åè¿‡é•¿/ä¸ä¸€è‡´

---

## ä»£ç å®¡æŸ¥å‘ç°

### 1. æ–‡æ¡£å’Œå®ç°ä¸ä¸€è‡´ (å…³é”®é—®é¢˜)

**é—®é¢˜**: README.md å’Œç¤ºä¾‹ä»£ç ä½¿ç”¨çš„ API ä¸å®é™…å®ç°ä¸ç¬¦

**è¯æ®**:
- README æ˜¾ç¤º: `CommandMetadata(name, group, doc, signature)`
- å®é™…å®ç°: `CommandMetadata(name, group, func, docstring, module, signature)`

**å½±å“**: æ–°ç”¨æˆ·ä¼šæ ¹æ®æ–‡æ¡£ç¼–å†™ä»£ç ï¼Œå¯¼è‡´ TypeError

**å»ºè®®**: 
- [ ] æ›´æ–° README.md ç¤ºä¾‹ä»£ç ä»¥åŒ¹é…å®é™… API
- [ ] æ·»åŠ æ³¨é‡Šè§£é‡Šä¸ºä»€ä¹ˆéœ€è¦ `func` å’Œ `module` å‚æ•°
- [ ] åœ¨ examples/ ä¸­æä¾›æ­£ç¡®çš„ç¤ºä¾‹

**ä¼˜å…ˆçº§**: ğŸ”´ é«˜ (P0)

---

### 2. API å‘½åä¸ä¸€è‡´

**é—®é¢˜**: ä¸åŒæ¨¡å—ä½¿ç”¨ä¸åŒçš„å‘½åçº¦å®š

| ç±» | é—®é¢˜æ–¹æ³• | å»ºè®® |
|----|---------|----|
| CommandInspector | `extract_metadata` | `inspect` (æ›´ç›´è§‚) |
| TableFormatter | `format_table` | `format` (æ›´ç®€æ´) |
| PerformanceMonitor | `get_stats` / `get_all_stats` | ç»Ÿä¸€ä¸ºä¸€ä¸ªæ–¹æ³• |

**å½±å“**: API å­¦ä¹ æ›²çº¿å¢åŠ ï¼Œæ˜“å‡ºé”™

**å»ºè®®**: 
- [ ] ç»Ÿä¸€å‘½åçº¦å®šï¼ˆæ¨èï¼š`inspect`, `format`, `get_stats`ï¼‰
- [ ] æ›´æ–°æ‰€æœ‰è°ƒç”¨ä»£ç 
- [ ] æ›´æ–°æ–‡æ¡£å’Œç¤ºä¾‹

**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­ (P1)

---

### 3. æ•°æ®æ¨¡å‹å­—æ®µå‘½å

**é—®é¢˜**: ExecutionRecord ä½¿ç”¨ `command_name` è€Œ PerformanceStats ä¹Ÿä½¿ç”¨ `command_name`ï¼Œä½†åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ `command`

**å½±å“**: æ··ä¹±ï¼Œæ˜“å‡ºé”™

**å»ºè®®**: 
- [ ] ç»Ÿä¸€ä½¿ç”¨ `command_name`ï¼ˆæ›´æ¸…æ™°ï¼‰
- [ ] æˆ–æ·»åŠ  `command` å±æ€§ä½œä¸ºåˆ«åï¼ˆå‘åå…¼å®¹ï¼‰

**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­ (P1)

---

### 4. å…¬å…± API è¡¨è¿°ç¼ºé™·

**é—®é¢˜**: æµ‹è¯•ä»£ç éœ€è¦è®¿é—®å†…éƒ¨å±æ€§ï¼ˆå¦‚ `_tracking`ï¼‰æ¥éªŒè¯çŠ¶æ€

**æ ¹æœ¬åŸå› **: ExecutionTracker æ²¡æœ‰å…¬å…±æ–¹æ³•æ¥æŸ¥è¯¢è¿½è¸ªçŠ¶æ€

**å½“å‰**: 
```python
tracker._tracking  # ç›´æ¥è®¿é—®ç§æœ‰å±æ€§ï¼ˆä¸å¥½ï¼ï¼‰
```

**åº”è¯¥**:
```python
tracker.is_tracking_enabled()  # å…¬å…±æ–¹æ³• âœ…
```

**å½±å“**: ç±»çš„å°è£…æ€§å·®

**å»ºè®®**: 
- [ ] ä¸º ExecutionTracker æ·»åŠ  `is_tracking_enabled()` æ–¹æ³•
- [ ] åœ¨æ‰€æœ‰ç›¸å…³ä»£ç ä¸­ä½¿ç”¨å…¬å…± API

**ä¼˜å…ˆçº§**: ğŸ”´ é«˜ (P0)

---

## æµ‹è¯•è¦†ç›–åˆ†æ

### åˆå§‹æµ‹è¯•è¿è¡Œç»“æœ
- **æ€»æµ‹è¯•æ•°**: 48
- **é€šè¿‡**: 17 (35%)
- **å¤±è´¥**: 31 (65%)

### å¤±è´¥åŸå› åˆ†å¸ƒ
| åŸå›  | æ•°é‡ | ç™¾åˆ†æ¯” |
|------|------|--------|
| API å‚æ•°é”™è¯¯ | 18 | 58% |
| æ–¹æ³•åé”™è¯¯ | 7 | 23% |
| å±æ€§è®¿é—®é”™è¯¯ | 4 | 13% |
| å…¶ä»– | 2 | 6% |

### å…³é”®è§‚å¯Ÿ
1. **å¤§å¤šæ•°å¤±è´¥æ˜¯ç”±äºæ–‡æ¡£å’Œå®ç°ä¸åŒ¹é…** - è¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å¯ç»´æŠ¤æ€§é—®é¢˜
2. **æœ‰äº›æµ‹è¯•ç¡®å®é€šè¿‡äº†** (17 ä¸ª) - è¯´æ˜æ ¸å¿ƒåŠŸèƒ½å·¥ä½œæ­£å¸¸
3. **æ¨¡å—ä¹‹é—´å­˜åœ¨ API é£æ ¼ä¸ä¸€è‡´** - éœ€è¦ç»Ÿä¸€

---

## å®¡æŸ¥å»ºè®® (ä¼˜å…ˆçº§æ’åº)

### P0 - ç«‹å³ä¿®å¤ (é˜»å¡)
1. [ ] **æ›´æ–° README.md ç¤ºä¾‹ä»£ç ** - ä¸å®ç°ä¸€è‡´
2. [ ] **æ·»åŠ å…¬å…±çŠ¶æ€æŸ¥è¯¢ API** - ExecutionTracker.is_tracking_enabled()
3. [ ] **ä¿®å¤ CommandMetadata æ–‡æ¡£** - æ¸…æ™°è¯´æ˜æ‰€æœ‰ 6 ä¸ªå‚æ•°

### P1 - åº”è¯¥ä¿®å¤ (å½±å“ä½¿ç”¨)
1. [ ] **ç»Ÿä¸€ API å‘½å** - `inspect`, `format`, `get_stats` ç­‰
2. [ ] **ç»Ÿä¸€å­—æ®µå‘½å** - æ‰€æœ‰åœ°æ–¹éƒ½ç”¨ `command_name`
3. [ ] **å®Œå–„ TableConfig** - å‚æ•°åæ›´è‡ªè§£é‡Š

### P2 - å¯ä»¥æ”¹è¿› (ä¼˜åŒ–)
1. [ ] **ä¸ºæ•°æ®æ¨¡å‹æ·»åŠ æ›´å¤šéªŒè¯**
2. [ ] **æ·»åŠ ç±»å‹æ£€æŸ¥è£…é¥°å™¨**
3. [ ] **å®Œå–„é”™è¯¯æ¶ˆæ¯**

---

## ä¸‹ä¸€æ­¥

1. âœ… **ç°åœ¨**: æ ¹æ®å®é™… API ä¿®æ­£æ‰€æœ‰æµ‹è¯•ä»£ç 
2. â³ **æ¥ä¸‹æ¥**: é‡æ–°è¿è¡Œæµ‹è¯•ï¼Œç¡®ä¿ 100% é€šè¿‡
3. â³ **ç„¶å**: æ‰§è¡Œå®Œæ•´çš„ä»£ç å®¡æŸ¥è®¡åˆ’ (12 ä¸ªå®¡æŸ¥é¡¹)
4. â³ **æœ€å**: ç”Ÿæˆæœ€ç»ˆæŠ¥å‘Šå¹¶åšå‡ºæ”¹è¿›å»ºè®®

---

## å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ |
|------|------|------|
| API æ–‡æ¡£ä¸€è‡´æ€§ | âŒ ä½ | âœ… 100% |
| æµ‹è¯•é€šè¿‡ç‡ | 35% | 100% |
| ä»£ç è¦†ç›–ç‡ | å¾…æ£€ | > 90% |
| API å‘½åä¸€è‡´æ€§ | ğŸŸ¡ ä¸­ | âœ… é«˜ |

---

**æŠ¥å‘Šæ—¥æœŸ**: 2026-01-25  
**å®¡æŸ¥è€…**: GitHub Copilot  
**å·¥ä½œåŒº**: .worktrees/registry-code-review
